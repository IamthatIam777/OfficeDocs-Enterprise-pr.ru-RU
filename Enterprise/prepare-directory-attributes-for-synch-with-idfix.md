---
title: Подготовка атрибутов каталога для синхронизации с Office 365 с помощью инструмента IdFix
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.custom: Adm_O365
ms.collection:
- Ent_O365
- M365-identity-device-management
search.appverid:
- MET150
- MOE150
ms.assetid: 497593cf-24c6-491c-940b-7c86dcde9de0
description: В этой статье приведены инструкции по использованию IdFix для подготовки и очистки локального каталога перед синхронизацией с Office 365.
ms.openlocfilehash: cdfee8178f731d20c799f550d1dacb0a04a72cae
ms.sourcegitcommit: 1b6ba4043497c27b3a89689766b975f2405e0ec8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2019
ms.locfileid: "30085098"
---
# <a name="prepare-directory-attributes-for-synchronization-with-office-365-by-using-the-idfix-tool"></a>Подготовка атрибутов каталога для синхронизации с Office 365 с помощью инструмента IdFix
В этом разделе содержатся подробные инструкции по запуску средства IdFix, часто возникающим ошибкам, предлагаемым исправлениям, примерам и рекомендациям по выполнению действий при большом количестве ошибок.
  
## <a name="fixing-errors-in-your-directory-by-using-the-idfix-gui"></a>Устранение ошибок в каталоге с помощью графического интерфейса пользователя IdFix
[Запустите средство Office 365 IdFix](install-and-run-idfix.md) для поиска проблем в каталоге, а затем исправьте ошибки в графическом интерфейсе, как описано в этом разделе. Если средство возвращает пустую таблицу, ошибки не обнаружены. Если в каталоге много проблем, это может привести к переполнению, когда средство возвращает ошибки. Один из способов решить эту проблему — устранить все ошибки первого типа, а затем перейти к следующему типу. 
  
1. Прежде чем вносить изменения ознакомьтесь с рекомендациями, представленными IdFix.
    
2. Просмотрите список ошибок, которые вернул IdFix. Вы можете отсортировать ошибки по типу, щелкнув **ERROR** вверху столбца с типами ошибок. Если с атрибутом связано более одной ошибки, ошибки будут объединены в одну строку. При наличии возможности IdFix предоставляет рекомендации по их исправлению в столбце **UPDATE**. Это исправление основано на проверке других атрибутов, связанных с объектом. Хотя они обычно лучше атрибутов, указанных в каталоге, только вы можете решить какой из них действительно точный. 
    
3. Если в IdFix есть предложение об исправлении ошибки дублирования, это исправление определяется одним из трех флагов в начале значения в столбце **Обновление** , например `[E]john.doe@contoso.com`. Если вы принимаете предложение, то при применении изменения флаг не будет вставлен в каталог. Будет применено только значение, которое следует за флагом предложения, например `john.doe@contoso.com`. Если вы хотите принять предложение, выберите соответствующее действие из столбца **Action (действие** ). Флаги указывают действия следующим образом: 
    
 - **[C]**: предлагаемое действие — **COMPLETE**. Это значение не нуждается в редактировании.
    
 - **[E]**: предлагаемое действие — **EDIT**. Это значение следует изменить во избежание конфликтов с другим значением в каталоге.
    
 - **[R]**: предлагаемое действие — **REMOVE**. Это значение прокси-сервера SMTP на не включенный в почтовый ящик объект и может быть безопасно удалено.
    
4. После того как вы прочитали и поняли ошибки, обновите запись в столбце **Обновление** , добавив свои изменения, а затем в столбце **Action (действие** ) выберите, какие действия необходимо выполнить IdFix для реализации изменения. Например, два пользователя могут быть `proxyAddress` идентифицированы как дубликаты. Только один пользователь может использовать `proxyAddress` для доставки почты. Чтобы устранить эту проблему, пометьте столбец **** **действие** как завершенный для пользователя с правильным значением и пометьте **** столбец действие **удален** для другого пользователя. Это приведет к `proxyAddress` удалению атрибута из пользователя, которому `proxyAddress` он не принадлежит, и не вносит изменения в пользователя, для которого `proxyAddress` это верно.
    
## <a name="common-errors-and-fixes-detected-by-idfix"></a>Распространенные ошибки, обнаруживаемые IdFix, и способы их исправления
В следующей таблице описаны ошибки, определяемые IdFix, приведены предлагаемые инструментом наиболее распространенные способы их решения, а в некоторых случаях — примеры их исправления.

|**ОШИБКОЙ**|**Описание типа ошибки**|**Предлагаемое решение**|**Пример**|
|:-----|:-----|:-----|:-----|
|**character** | Недопустимые знаки. Значение содержит символ, который является недопустимым. | Предлагаемое решение этой ошибки, отображаемой в столбце **UPDATE**, представлено в виде значения, из которого удален недопустимый символ.  <br/> | Замыкающий пробел в конце допустимого почтового адреса является недопустимым символом, например:  <br/> " `user@contoso.com` "  <br/> Начальное место в начале допустимого почтового адреса является недопустимым символом, например:  <br/> " ` user@contoso.com `"  <br/>  `ú` Символ содержит недопустимый символ. |
|**duplicate** | Повторяющаяся запись. Данное значение повторяется в рамках запроса. Все повторяющиеся значения будут отображены как ошибки. | Измените или удалите значения, чтобы избежать повторений. Данный инструмент не предоставляет исправлений для повторяющихся значений. Вместо этого вы можете выбрать запись, для которой повторяющееся значение является правильным, а остальные записи удалить. ||
|**format** | Ошибка форматирования. Данное значение нарушает требования к формату использования атрибута. | В качестве предлагаемого обновленного значения будет отображено значение с удаленными недопустимыми знаками. Если недопустимых символов нет, то значения в столбцах Update и Value будут совпадать. Необходимо определить, что вам требуется в обновлении. Данный инструмент не предоставляет исправлений для всех ошибок форматирования. | Например, SMTP-адреса должны соответствовать стандартам RFC 2822 и mailNickName не могут начинаться или заканчиваться точкой. Дополнительные сведения о требованиях к формату атрибутов каталога приведены в разделе "Подготовка к использованию объектов каталога и атрибутов" в статье [Подготовка к подготовке пользователей через синхронизацию каталогов к Office 365](prepare-for-directory-synchronization.md). |
|topleveldomain  <br/> |Домен верхнего уровня. Это относится к значениям, подлежащим формату [RFC 2822](https://go.microsoft.com/fwlink/p/?LinkId=401464) . Если домен верхнего уровня не поддерживает маршрутизацию в Интернете, он будет идентифицирован как ошибка. Например, SMTP-адрес, заканчивающийся на Local, не поддерживает маршрутизацию в Интернете и вызовет эту ошибку. |Измените значение на домен с маршрутизацией в Интернете, `.com` например или `.net`. | `myaddress@fourthcoffee.local` Смените `fourthcoffee.com` или другой маршрутизируемый домен, маршрутизируемый через Интернет.  <br/> Инструкции по [подготовке домена, не поддерживающего маршрутизацию (например, локального домена), для синхронизации службы каталогов](prepare-a-non-routable-domain-for-directory-synchronization.md). |
|**domainpart** | Ошибка в доменной части. Эта ошибка применяется к значениям, подлежащим форматированию в соответствии с RFC 2822. Она отображается, если часть имени домена указана неправильно или не соответствует RFC 2822. | Измените значение на значение, которое соответствует RFC 2822. Например, убедитесь, что он не содержит пробелов или недопустимых символов. | Замените `myaddress@fourth coffee.com` на `myaddress@fourthcoffee.com`. |
|**домаинпарт_локалпарт** | Ошибка в локальной части домена. Эта ошибка применяется к значениям, подлежащим форматированию в соответствии с RFC 2822. Она отображается, если локальная часть указана неправильно или не соответствует RFC 2822. |Измените значение на значение, которое соответствует RFC 2822. Например, убедитесь, что он не содержит пробелов или недопустимых символов. |Замените `my"work"address@fourthcoffee.com` на `myworkaddress@fourthcoffee.com`. |
|**length** | Ошибка длины. Это значение нарушает ограничение по длине для данного атрибута. Эта ошибка чаще всего возникает при изменении схемы каталога.  | Обновление, предлагаемое IdFix, усечет имеющееся значение до допустимой длины.  <br/> Имейте в виду, что это может привести к нежелательным результатам. Перед тем как нажать кнопку **Apply** (Применить) просмотрите предлагаемое исправление и измените его, если это необходимо. ||
|**blank**  | Ошибка: пустое или нулевое множество. Это значение нарушает ограничение на ненулевое множество для синхронизируемых атрибутов. Только несколько атрибутов должны содержать значение. | Если это возможно, предложенное обновленное значение будет использовать значения других атрибутов для получения похожей подставляемой величины. ||
|**mailmatch** | Это относится только к Office 365 выделенным. Значение не отвечает атрибуту почты. | Предлагаемое обновление будет иметь значение атрибута почты с префиксом "SMTP:". ||
    
## <a name="operations-you-can-perform-by-using-idfix"></a>Операции, доступные в IdFix
Чтобы исправить ошибку, выберите параметр из раскрывающегося списка **действий** . В следующей таблице описываются операции **действий** , которые можно выполнять над атрибутами с помощью средства IdFix. Если оставить столбец **действия** пустым, средство IdFix не будет предпринимать никаких действий с этой ошибкой в каталоге. 

|**МЕРЫ**|**Описание**|**Пример**|
|:-----|:-----|:-----|
|**COMPLETE** | Исходное значение является приемлемым и не должно быть изменено несмотря на то, что оно идентифицировано как ошибка. | У двух пользователей имеется значение proxyAddress, идентифицированное как повторяющееся. Один из них может использовать это значение для доставки электронной почты. Отметьте пользователя с правильным значением как **COMPLETE**. |
|**УДАЛИТЬ** | Значение атрибута будет удалено из исходного объекта. Например `proxyAddresses`, при многозначном атрибуте будет удалено только отдельное отображаемое значение. | У двух пользователей имеется значение proxyAddress, идентифицированное как повторяющееся. Один из них может использовать это значение для доставки электронной почты. Отметьте пользователя с повторяющимся значением как **REMOVE**. |
|**Правка** | Сведения в столбце " **Обновление** " будут использоваться для изменения значения атрибута. Если для IdFix предложено допустимое значение **обновления** , в столбце **действие** выберите **изменить** и перейдите к следующей ошибке. Если вам не нравится предложение, введите новый элемент в столбец **Обновление** , а затем в столбце **действие** выберите команду **изменить**. ||
|**ОТКАТ** | Этот параметр доступен только в том случае, если пользователь восстановлен из журнала транзакций. Если выбрать **UNDO**, будет восстановлено исходное значение атрибута. ||
|**FAIL** | Это значение возвращается, только если значение **обновления** содержит неизвестный конфликт с правилами доменных служб Active Directory. В этом случае вы можете изменить значение в столбце **Обновление** , если вы знаете, что происходит в случае сбоя. Может потребоваться проанализировать значения объекта с помощью редактора ADSI. Дополнительные сведения см. в разделе [Редактирование ADSI (adsiedit. msc)](https://go.microsoft.com/fwlink/p/?LinkId=401170). ||

После выбора действия **ACTION** для ошибки или ряда ошибок, нажмите кнопку **Применить**. При нажатии кнопки **Apply** (Применить) средство внесет изменения в каталог. Вы можете предоставить исправления для нескольких ошибок, а потом нажать кнопку **Apply**, чтобы IdFix изменил их все за один раз.

Запустите IdFix еще раз, чтобы убедиться, что в внесенных исправлениях не были внесены новые ошибки. Эти действия можно повторять столько раз, сколько необходимо. Перед синхронизацией рекомендуется пройти процесс несколько раз.
    
## <a name="changing-the-rule-set-used-by-idfix"></a>Изменение набора правил, используемого IdFix
По умолчанию IdFix использует набор правил для нескольких клиентов для проверки записей в каталоге. Это правильный набор правил для большинства Office 365 = Клиенты. Тем не менее, если вы настроили Office 365 или ITAR (международный трафик в вооруженных нормах), вы можете настроить IdFix для использования выделенного набора правил. Если вы не знаете, какой тип клиента вы знаете, вы можете спокойно пропустить этот шаг. Чтобы задать для правила значение выделенный, щелкните значок шестеренки в строке меню и выберите выделенный ****.
  
## <a name="changing-the-scope-of-the-search-used-by-idfix"></a>Изменение области поиска, используемого IdFix
По умолчанию IdFix ищет по всему каталогу. Если необходимо, вместо этого можно настроить инструмент для поиска в определенном поддереве. Для этого в строке меню нажмите значок фильтра и выберите нужное поддерево.
  
## <a name="rolling-back-your-changes-by-using-the-idfix-gui"></a>Откат изменений с помощью графического интерфейса пользователя IdFix
При каждом нажатии кнопки **Применить** для применения изменений средство IdFix создает отдельный файл, который называется журналом транзакций, в котором перечисляются только что внесенные изменения. С помощью журнала транзакций можно откатить только те изменения, которые находятся в последнем журнале в случае ошибки. Если во время обновления допущена ошибка, вы можете отменить последние примененные изменения, нажав кнопку **отменить**. При нажатии кнопки **Отмена**, IdFix использует журнал транзакций для отката только тех изменений, которые находятся в последнем журнале транзакций. Дополнительные сведения об использовании журнала транзакций приведены в статье [справочник: журнал транзакций Office 365 IdFix](idfix-transaction-log.md).