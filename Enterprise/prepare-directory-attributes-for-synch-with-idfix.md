---
title: Подготовка атрибутов каталога для синхронизации с Office 365 с помощью инструмента IdFix
ms.author: josephd
author: JoeDavies-MSFT
manager: laurawi
audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.custom: Adm_O365
ms.collection:
- Ent_O365
- M365-identity-device-management
search.appverid:
- MET150
- MOE150
ms.assetid: 497593cf-24c6-491c-940b-7c86dcde9de0
description: В этой статье приведены инструкции по использованию IdFix для подготовки и очистки локального каталога перед синхронизацией с Office 365.
ms.openlocfilehash: 623dc38290b44dd69644b24f7640b0d49bcd7722
ms.sourcegitcommit: a9804062071939b7b7e60da5b69f484ce1d34ff8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2019
ms.locfileid: "39814617"
---
# <a name="prepare-directory-attributes-for-synchronization-with-office-365-by-using-the-idfix-tool"></a>Подготовка атрибутов каталога для синхронизации с Office 365 с помощью инструмента IdFix

*Эта статья относится к Office 365 корпоративный и Microsoft 365 корпоративный.*

В этом разделе содержатся подробные инструкции по запуску средства IdFix, часто возникающим ошибкам, предлагаемым исправлениям, примерам и рекомендациям по выполнению действий при большом количестве ошибок.
  
## <a name="fixing-errors-in-your-directory-by-using-the-idfix-gui"></a>Устранение ошибок в каталоге с помощью графического интерфейса пользователя IdFix

[Запустите средство Office 365 IdFix](install-and-run-idfix.md) для поиска проблем в каталоге, а затем исправьте ошибки в графическом интерфейсе, как описано в этом разделе. Если средство возвращает пустую таблицу, ошибки не обнаружены. Если в каталоге много проблем, это может привести к переполнению, когда средство возвращает ошибки. Один из способов решить эту проблему — устранить все ошибки первого типа, а затем перейти к следующему типу. 
  
1. Прежде чем вносить изменения, ознакомьтесь с рекомендациями, представленными в IdFix.
    
2. Просмотрите список ошибок, возвращаемых IdFix. Вы можете сортировать ошибки по типу, щелкая **ОШИБКА** в верхней части столбца, в котором перечислены типы ошибок. Если с одним атрибутом связано более одной ошибки, ошибки объединяются в одну строку. Там, где это возможно, IdFix предоставляет рекомендации по исправлению в столбце " **Обновление** ". Исправление зависит от проверки других атрибутов, связанных с объектом. Как правило, это лучше, чем уже в каталоге, но вы можете определить, что именно именно точнее. 
    
3. Если в IdFix есть предложение об исправлении ошибки дублирования, это исправление определяется одним из трех флагов в начале значения в столбце **Обновление** , например `[E]john.doe@contoso.com`. Если вы принимаете предложение, то при применении изменения флаг не будет вставлен в каталог. Будет применено только значение, которое следует за флагом предложения, например `john.doe@contoso.com`. Если вы хотите принять предложение, выберите соответствующее действие из столбца **Action (действие** ). Флаги указывают действия следующим образом: 
    
 - **[C]** предлагаемое действие **завершено**. Значение не требуется редактировать.
    
 - **[E]** **изменение**предлагаемого действия. Значение должно быть изменено во избежание конфликта с другим значением в каталоге.
    
 - **[R]** **Удаление**предлагаемого действия. Значение является прокси-сервером SMTP для объекта, не поддерживающего почту, и его можно удалить.
    
4. После того как вы прочитали и поняли ошибки, обновите запись в столбце **Обновление** , добавив свои изменения, а затем в столбце **Action (действие** ) выберите, какие действия необходимо выполнить IdFix для реализации изменения. Например, два пользователя могут быть `proxyAddress` идентифицированы как дубликаты. Только один пользователь может использовать `proxyAddress` для доставки почты. Чтобы устранить эту проблему, пометьте столбец **действие** как **завершенный** для пользователя с правильным значением и пометьте **** столбец действие **удален** для другого пользователя. Это приведет к `proxyAddress` удалению атрибута из пользователя, которому `proxyAddress` он не принадлежит, и не вносит изменения в пользователя, для которого `proxyAddress` это верно.
    
## <a name="common-errors-and-fixes-detected-by-idfix"></a>Распространенные ошибки и исправления, обнаруженные в IdFix
В следующей таблице описываются ошибки, обнаруженные в IdFix, наиболее часто предлагаемые исправления из средства, а в некоторых случаях приведены примеры их устранения.

|**ОШИБКОЙ**|**Описание типа ошибки**|**Предлагаемое исправление**|**Пример**|
|:-----|:-----|:-----|:-----|
|**знаки** | Недопустимые символы. Значение содержит недопустимый символ. | Предлагаемое исправление ошибки, показанное в столбце **Обновление** , содержит значение с удаленным недопустимым символом.  <br/> | Замыкающий пробел в конце допустимого почтового адреса является недопустимым символом, например:  <br/> " `user@contoso.com` "  <br/> Начальное место в начале допустимого почтового адреса является недопустимым символом, например:  <br/> " ` user@contoso.com `"  <br/>  `ú` Символ содержит недопустимый символ. |
|**повторять** | Повторяющаяся запись. Значение дублируется в области запроса. Все повторяющиеся значения будут отображаться как ошибки. | Измените или удалите значения, чтобы устранить дублирование. Средство не предоставит предлагаемое исправление для дубликатов. Вместо этого необходимо выбрать, какое из двух или более дубликатов является правильным и удалить дублирующуюся запись или записи. ||
|**format** | Ошибка форматирования. Значение нарушает требования к формату использования атрибута. | Предлагаемое обновление будет показывать значение с удаленными недопустимыми символами. Если нет недопустимых символов, обновление и значение будут отображаться одинаково. Вам нужно определить, что вы действительно хотите в обновлении. Средство не предоставит предлагаемое исправление для всех ошибок форматирования. | Например, SMTP-адреса должны соответствовать стандартам RFC 2822 и mailNickName не могут начинаться или заканчиваться точкой. Дополнительные сведения о требованиях к формату атрибутов каталога приведены в разделе "Подготовка к использованию объектов каталога и атрибутов" в статье [Подготовка к подготовке пользователей через синхронизацию каталогов к Office 365](prepare-for-directory-synchronization.md). |
|топлевелдомаин  <br/> |Домен верхнего уровня. Это относится к значениям, подлежащим формату [RFC 2822](https://go.microsoft.com/fwlink/p/?LinkId=401464) . Если домен верхнего уровня не поддерживает маршрутизацию в Интернете, он будет идентифицирован как ошибка. Например, SMTP-адрес, заканчивающийся на Local, не поддерживает маршрутизацию в Интернете и вызовет эту ошибку. |Измените значение на домен с маршрутизацией в Интернете, `.com` например или `.net`. | `myaddress@fourthcoffee.local` Смените `fourthcoffee.com` или другой маршрутизируемый домен, маршрутизируемый через Интернет.  <br/> Инструкции по [подготовке домена, не поддерживающего маршрутизацию (например, локального домена), для синхронизации службы каталогов](prepare-a-non-routable-domain-for-directory-synchronization.md). |
|**домаинпарт** | Ошибка части домена. Это относится к значениям, подлежащим формату RFC 2822. Если часть значения домена является недопустимой и не соответствует спецификации RFC 2822, то будет создано. | Измените значение на значение, которое соответствует RFC 2822. Например, убедитесь, что он не содержит пробелов или недопустимых символов. | Замените `myaddress@fourth coffee.com` на `myaddress@fourthcoffee.com`. |
|**domainpart_localpart** | Ошибка локальной части. Это относится к значениям, подлежащим формату RFC 2822. Если локальная часть значения является недопустимой и не соответствует стандарту RFC 2822, это будет создано. |Измените значение на значение, которое соответствует RFC 2822. Например, убедитесь, что он не содержит пробелов или недопустимых символов. |Замените `my"work"address@fourthcoffee.com` на `myworkaddress@fourthcoffee.com`. |
|**длина** | Ошибка длины. Значение нарушает ограничения на длину атрибута. Чаще всего такая ошибка возникает при изменении схемы каталога.  | Обновление, предлагаемое IdFix, усекает значение до допустимой длины.  <br/> Имейте в виду, что это может привести к нежелательным результатам. Перед нажатием кнопки **Применить**необходимо проверить предлагаемое исправление и изменить его. ||
|**одни**  | Пустая или пустая ошибка. Значение нарушает ограничение NULL для синхронизируемых атрибутов. Только несколько атрибутов должны содержать значение. | Если это возможно, предлагаемое обновление будет использовать другие значения атрибутов для создания вероятного подстановки. ||
|**маилматч** | Это относится только к Office 365 выделенным. Значение не отвечает атрибуту почты. | Предлагаемое обновление будет иметь значение атрибута почты с префиксом "SMTP:". ||
    
## <a name="operations-you-can-perform-by-using-idfix"></a>Операции, которые можно выполнять с помощью IdFix
Чтобы исправить ошибку, выберите параметр из раскрывающегося списка **действий** . В следующей таблице описываются операции **действий** , которые можно выполнять над атрибутами с помощью средства IdFix. Если оставить столбец **действия** пустым, средство IdFix не будет предпринимать никаких действий с этой ошибкой в каталоге. 

|**МЕРЫ**|**Описание**|**Пример**|
|:-----|:-----|:-----|
|**ЗАПОЛНИТЬ** | Исходное значение является приемлемым и не должно изменяться, несмотря на то, что оно идентифицировано как ошибка. | Два пользователя proxyAddress идентифицированы как повторяющиеся. Только один из них может использовать значение для доставки почты. Помечайте пользователя, указав правильное значение как **завершенное**. |
|**УДАЛИТЬ** | Значение атрибута будет удалено из исходного объекта. Например `proxyAddresses`, при многозначном атрибуте будет удалено только отдельное отображаемое значение. | Два пользователя proxyAddress идентифицированы как повторяющиеся. Только один из них может использовать значение для доставки почты. Помечайте пользователя, используя повторяющееся значение, как **Remove**. |
|**Правка** | Сведения в столбце " **Обновление** " будут использоваться для изменения значения атрибута. Если для IdFix предложено допустимое значение **обновления** , в столбце **действие** выберите **изменить** и перейдите к следующей ошибке. Если вам не нравится предложение, введите новый элемент в столбец **Обновление** , а затем в столбце **действие** выберите команду **изменить**. ||
|**ОТКАТ** | Этот параметр доступен только в том случае, если вы выполнили восстановление из журнала транзакций. Если выбрать пункт **отменить**, значение атрибута будет восстановлено до исходного значения. ||
|**FAIL** | Это значение возвращается, только если значение **обновления** содержит неизвестный конфликт с правилами доменных служб Active Directory. В этом случае вы можете изменить значение в столбце **Обновление** , если вы знаете, что происходит в случае сбоя. Может потребоваться проанализировать значения объекта с помощью редактора ADSI. Дополнительные сведения см. в разделе [Редактирование ADSI (adsiedit. msc)](https://go.microsoft.com/fwlink/p/?LinkId=401170). ||

После выбора **действия** для ошибки или пакета ошибок нажмите кнопку **Применить**. При нажатии кнопки **Применить** инструмент вносит изменения в каталог. Вы можете предоставить исправления для нескольких ошибок, прежде чем нажать кнопку **Применить** и IdFix будет изменять их все одновременно.

Запустите IdFix еще раз, чтобы убедиться, что в внесенных исправлениях не были внесены новые ошибки. Можно повторять эти действия столько раз, сколько необходимо. Рекомендуется выполнить этот процесс перед синхронизацией несколько раз.
    
## <a name="changing-the-rule-set-used-by-idfix"></a>Изменение набора правил, используемого в IdFix
По умолчанию для тестирования записей в каталоге IdFix использует многопользовательский набор правил. Это правильный набор правил для большинства Office 365 = Клиенты. Тем не менее, если вы настроили Office 365 или ITAR (международный трафик в вооруженных нормах), вы можете настроить IdFix для использования выделенного набора правил. Если вы не знаете, к какому типу пользователей относитесь, пропустите этот шаг. Чтобы задать для правила значение выделенный, щелкните значок шестеренки в строке меню и выберите **выделенный**.
  
## <a name="changing-the-scope-of-the-search-used-by-idfix"></a>Изменение области поиска, используемого в IdFix
По умолчанию IdFix выполняет поиск во всем каталоге. При желании вы можете настроить средство для поиска определенного поддерева вместо этого. Для этого в строке меню щелкните значок фильтра и введите допустимое поддерево.
  
## <a name="rolling-back-your-changes-by-using-the-idfix-gui"></a>Откат изменений с помощью графического интерфейса пользователя IdFix
При каждом нажатии кнопки **Применить** для применения изменений средство IdFix создает отдельный файл, который называется журналом транзакций, в котором перечисляются только что внесенные изменения. С помощью журнала транзакций можно откатить только те изменения, которые находятся в последнем журнале в случае ошибки. Если во время обновления допущена ошибка, вы можете отменить последние примененные изменения, нажав кнопку **отменить**. При нажатии кнопки **Отмена**, IdFix использует журнал транзакций для отката только тех изменений, которые находятся в последнем журнале транзакций. Дополнительные сведения об использовании журнала транзакций приведены в статье [справочник: журнал транзакций Office 365 IdFix](idfix-transaction-log.md).

## <a name="next-step"></a>Следующий шаг

[Настройка синхронизации каталогов](set-up-directory-synchronization.md)
