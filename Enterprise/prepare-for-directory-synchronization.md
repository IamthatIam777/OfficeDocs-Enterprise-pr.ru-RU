---
title: Подготовка к подготовке пользователей с помощью синхронизации службы каталогов в Office 365
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
ms.audience: Admin
ms.topic: article
f1_keywords:
- O365p_AddUsersWithDirSync
- O365M_AddUsersWithDirSync
- O365E_HRCSetupAADConnectAboutLM617031
- O365E_AddUsersWithDirSync
ms.service: o365-administration
localization_priority: Normal
ms.custom: Adm_O365
search.appverid:
- MET150
- MOP150
- MOE150
- MBS150
ms.assetid: 01920974-9e6f-4331-a370-13aea4e82b3e
description: Описывается подготовка к подготовке пользователей в Office 365 с помощью синхронизации службы каталогов, а также долгосрочные преимущества применения такого метода.
ms.openlocfilehash: 8e84f4602b79ce321cd9a71e6c35331baf40f7f0
ms.sourcegitcommit: c5761d3c41aa2d26815f0d24c73dbcd53ab37957
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/19/2018
ms.locfileid: "27371123"
---
# <a name="prepare-to-provision-users-through-directory-synchronization-to-office-365"></a>Подготовка к подготовке пользователей с помощью синхронизации службы каталогов в Office 365

Подготовка пользователей с помощью синхронизации службы каталогов требуется несколько планирование и подготовка, чем просто Управление учетной записью работы или школы непосредственно в Office 365. Чтобы убедиться, что Active Directory локальной должным образом синхронизируется с Azure Active Directory необходимы дополнительные задачи планирования и подготовки. Следующие дополнительные преимущества для вашей организации:
  
- Уменьшение количества программ администрирования в организации
- При необходимости включая сценарий единого входа
- Автоматическое изменение учетной записи в Office 365
    
Дополнительные сведения о преимуществах использования синхронизации службы каталогов разделе [стратегия синхронизации каталогов]( https://go.microsoft.com/fwlink/p/?LinkId=525398) и [Общие сведения об Office 365 удостоверения и Azure Active Directory](about-office-365-identity.md).
  
Чтобы определить, какой сценарий лучше всего подходит для вашей организации, просмотрите [Сравнение средств интеграции каталогов](https://go.microsoft.com/fwlink/p/?LinkId=525320).
  
## <a name="directory-cleanup-tasks"></a>Задачи очистки каталога

Прежде чем начать синхронизацию, необходимо очистить каталог.
  
Просмотрите также [атрибуты синхронизируются с Azure Active Directory с Azure AD подключение](https://docs.microsoft.com/azure/active-directory/hybrid/reference-connect-sync-attributes-synchronized).
  
> [!IMPORTANT]
> Если не выполнить очистку каталогов, перед выполнением синхронизации, может быть существенное отрицательное влияние на процесс развертывания. Это может занять дни или даже недели, шла через цикл синхронизации службы каталогов, идентифицирующий ошибки и повторную синхронизацию. 
  
В локальном каталоге выполните следующие задачи очистки.
  
1. Убедитесь, что у каждого пользователя, который будет использовать службы Office 365, есть действительный и уникальный адрес электронной почты в атрибуте **proxyAddresses**. 
    
2. Удалите все повторяющиеся значения в атрибуте **proxyAddresses**. 
    
3.  Если это возможно убедитесь, что каждый пользователь, который будет назначен службы Office 365 имеет допустимое и уникальное значение для атрибута **userPrincipalName** в объекте **пользователя** пользователя. Для оптимального синхронизации убедиться, что в локальной Active Directory имени участника-пользователя соответствует облачных имени участника-пользователя. Если пользователь не имеет значения для атрибута **userPrincipalName** , объект **пользователя** должен содержать действительный и уникальные значения для атрибута **sAMAccountName** . Удалите все повторяющиеся значения в атрибут **userPrincipalName** . 
    
4. Для оптимального применения глобального списка адресов (GAL) проверьте правильность информации в следующих атрибутах:
    
  - givenName 
  - surname
  - отображаемое имя
  - Должность
  - Отдел
  - Кабинет
  - Рабочий телефон
  - Мобильный телефон
  - Номер факса
  - Улица, дом
  - Город
  - Область или район
  - Почтовый индекс
  - Страна или регион
    
## <a name="directory-object-and-attribute-preparation"></a>Подготовка объектов и атрибутов каталога

Успешные каталогов для синхронизации между локального каталога и Office 365 требуется, что ваше атрибутов каталога локального правильной подготовки. Например необходимо убедиться, что определенные знаки не используются в определенные атрибуты, синхронизированных со средой Office 365. Непредусмотренные символы не приводят к сбою синхронизации каталогов, но может возвращать предупреждения. Недопустимые символы приводят к сбою синхронизации каталогов.
  
Синхронизация службы каталогов также завершится ошибкой, если некоторые пользователи Active Directory имеет один или несколько повторяющихся атрибутов. Каждый пользователь должен иметь уникальные атрибуты.
  
Далее перечислены атрибуты, которые необходимо подготовить:
  
 **Примечание:** Можно также использовать [инструмент IdFix](install-and-run-idfix.md) к существенно упростить этот процесс. 
  
- **отображаемое имя**
    
  - Если в объекте пользователя существует атрибут, он будет синхронизирован с Office 365.
  - Если этот атрибут существует в объекте пользователя, для него должно быть предусмотрено значение. То есть атрибут не должен быть пустым.
  - Максимальное число символов: 256
    
- **givenName **
    
  - Если атрибут существует в объекте пользователя, он будет синхронизирован с Office 365, но он не требуется и не используется в Office 365.
  - Максимальное число символов: 64
    
- **mail**
    
  - Значение атрибута должно быть уникальным в пределах каталога.
    
    > [!NOTE]
    > Если существуют повторяющиеся значения, первый пользователь со значением синхронизируется. Пользователи не будут отображаться в Office 365. Измените значение в Office 365 или изменить оба значения в локальном каталоге в порядке для обоих пользователей в Office 365. 
  
- **mailNickname** (псевдоним Exchange) 
    
  - Значение атрибута не должно начинаться с точкой (.).
  - Значение атрибута должно быть уникальным в пределах каталога.
    
- **proxyAddresses **
    
  - Несколько значений атрибутов
  - Максимальное количество символов для одного значения: 256
  - Значение атрибута не должно содержать пробелы.
  - Значение атрибута должно быть уникальным в пределах каталога.
  - Недопустимые символы: \< \> (); , [ ] "
    
    Обратите внимание на то, что недопустимые символы, применяются к знаки, следующие тип разделителя и «:», таким образом, что может SMTP:User@contso.com, но не является SMTP:user:M@contoso.com.
    
    > [!IMPORTANT]
    > Все адреса транспортный протокол SMTP (Simple Mail) должны соответствовать требованиям стандартов электронной почты. Если существуют повторяющиеся или ненужные адреса, см раздел справки, [Удаление повторяющихся и нежелательных прокси-сервера в Exchange решает](https://go.microsoft.com/fwlink/?LinkId=293860). 
  
- **sAMAccountName**
    
  - Максимальное количество символов: 20
  - Значение атрибута должно быть уникальным в пределах каталога.
  - Недопустимые символы: [\ "|, /: \< \> + =;? \* ]
  - Если пользователь имеет недопустимый атрибут **sAMAccountName**, но имеет допустимый атрибут **userPrincipalName**, учетная запись пользователя создается в Office 365. 
  - Если и **sAMAccountName** и **userPrincipalName** недопустимы, необходимо обновить атрибут **userPrincipalName** локальной службы каталогов Active Directory. 
    
- **sn** (фамилия) 
    
  - Если атрибут существует в объекте пользователя, он будет синхронизирован с Office 365, но он не требуется и не используется в Office 365.
    
- **атрибут targetAddress**
    
    Это необходимо для атрибута **targetAddress** (например, SMTP:tom@contoso.com), который заполняется для пользователей, которые должны встречаться в Office 365 глобального списка адресов. В сценарии обмена сообщениями миграции сторонних производителей это требует расширения схемы в Office 365 для локального каталога. Расширения схемы в Office 365 также добавить другие полезные атрибуты для управления объектами Office 365, которые заполняются с помощью средства синхронизации каталогов в локальном каталоге. Например будет добавлен атрибут **msExchHideFromAddressLists** для управления скрытых почтовых ящиков или группы рассылки. 
   
  - Максимальное число символов: 256
  - Значение атрибута не должно содержать пробелы.
  - Значение атрибута должно быть уникальным в пределах каталога.
  - Недопустимые символы: \ \< \> (); , [ ] "
  - Все SMTP-адреса должны соответствовать стандартам обмена сообщениями электронной почты.
    
- **userPrincipalName**
    
  - Атрибут **userPrincipalName** должен быть в характерном для Интернета входа в формате, где имя пользователя следуют знак (@) и имя домена: например, user@contoso.com. Все адреса транспортный протокол SMTP (Simple Mail) должны соответствовать требованиям стандартов электронной почты.
  - Максимальное количество символов для атрибута **userPrincipalName**: 113. Перед знаком (@) и после него допускается определенное количество символов, а именно: 
  - Максимальное количество символов для имени пользователя, которое находится перед знаком (@): 64
  - Максимальное количество символов для имени домена, которое находится после знака (@): 48
  - Недопустимые символы: \ % &amp; \* + / =? { } | \< \> ( ) ; : , [ ] "
  - Две точки над гласной также является недопустимый символ.
  - Символ @ требуется в каждом значении **userPrincipalName** . 
  - Символ "@" не может быть первым символом в каждом значении **userPrincipalName**. 
  - Имя пользователя не может заканчиваться точкой (.), амперсанд (&amp;), места или несколько знака (@).
  - Имя пользователя не может содержать пробелы.
  - Необходимо использовать маршрутизируемые домены; Например нельзя использовать локальные или внутренние домены.
  - Символы кодировки Юникод преобразуются в символы подчеркивания.
  - **userPrincipalName** не может содержать дублирующиеся значения в каталоге. 
    
## <a name="prepare-the-userprincipalname-attribute"></a>Подготовка атрибута userPrincipalName

Active Directory позволяет конечным пользователям в организации для входа в каталоге с помощью **sAMAccountName** и **userPrincipalName**. Аналогично конечных пользователей можно войти в Office 365 с помощью имя участника-пользователя (UPN) их работы или школе учетной записи. Синхронизация службы каталогов предпринимается попытка создания новых пользователей в Azure Active Directory с помощью одного имени участника-пользователя, который находится в локальном каталоге. Имя участника-пользователя, отформатированное как адрес электронной почты. 

В Office 365 имя участника-пользователя является атрибутом по умолчанию, который используется для создания адреса электронной почты. Легко получить **userPrincipalName** (в локальной и в Azure Active Directory) и основной адрес электронной почты в **proxyAddresses** другие значения. Если они находятся в разных значения, может быть путаницы для администраторов и конечных пользователей. 
  
Рекомендуется выровнять эти атрибуты, чтобы избежать проблем. Для удовлетворения требований единого входа с помощью служб федерации Active Directory (AD FS) 2.0, необходимо убедиться, что UPN в Azure Active Directory и Active Directory локальной match с помощью допустимого доменных имен.
  
## <a name="add-an-alternative-upn-suffix-to-ad-ds"></a>Добавление альтернативного суффикса UPN в Доменных службах Active Directory

Может потребоваться добавление альтернативного суффикса имени участника-пользователя для связи организации учетные данные пользователя со средой Office 365. Суффикса имени участника-пользователя является частью имени участника-пользователя в правой части символ @. Имен участников-пользователей, которые используются для единого входа может содержать буквы, числа, периоды, тире и подчеркивания, но другие типы символов.
  
Дополнительные сведения о том, как добавление альтернативного суффикса имени участника-пользователя в Active Directory, см. [Подготовка к синхронизации службы каталогов]( https://go.microsoft.com/fwlink/p/?LinkId=525430).
  
## <a name="match-the-on-premises-upn-with-the-office-365-upn"></a>Соответствует имени участника-пользователя в локальной с Office 365 имени участника-пользователя

Если уже настройки синхронизации службы каталогов, имя участника-пользователя Office 365 могут не соответствовать пользователя в локальной имени участника-пользователя, который определен в вашей локальной службы каталогов. Это происходит, когда пользователь была назначена лицензия перед проверки домена. Чтобы устранить эту неполадку, обновите его имени участника-пользователя, чтобы убедиться, что имя участника-пользователя Office 365 с помощью [PowerShell для исправления дублированных имени участника-пользователя](https://go.microsoft.com/fwlink/p/?LinkId=396730) сопоставляет имя организации пользователя и домен. Если выполняется обновление имени участника-пользователя в локальной службе каталогов и требуется синхронизировать с идентификатором Azure Active Directory, необходимо удалить лицензии пользователя в Office 365 до внесения изменений в локальной. 
  
Также показано, [как подготовить без поддержки маршрутизации домена (например, .local домена) для синхронизации службы каталогов](prepare-a-non-routable-domain-for-directory-synchronization.md).
  
## <a name="directory-integration-tools"></a>Средства интеграции каталогов

Синхронизация службы каталогов является синхронизации каталогов объекты (пользователей, групп и контакты) из локальной среды Active Directory в Office 365 directory инфраструктуру, Azure Active Directory. В разделе [Средства интеграции каталогов](https://go.microsoft.com/fwlink/p/?LinkID=510956) список доступных средств и их функциональных возможностей. Рекомендуемые средства — [Microsoft Azure Active Directory подключение](https://go.microsoft.com/fwlink/p/?LinkID=510956). Дополнительные сведения о подключения Azure Active Directory в разделе [Интеграция вашей локальной удостоверения с помощью Azure Active Directory](https://go.microsoft.com/fwlink/p/?LinkId=527969).
  
При синхронизации учетных записей пользователей с Office 365 каталогов в первый раз, то они помечены как не активирован. Не могут отправлять и получать электронную почту, и они не используют лицензий на подписку. Когда вы будете готовы для назначения подписки на Office 365 для конкретных пользователей, необходимо выбрать и активировать их, [Назначение лицензий для пользователей в Office 365 для бизнеса](https://support.office.com/article/997596b5-4173-4627-b915-36abac6786dc).
  
Можно также использовать [PowerShell](https://go.microsoft.com/fwlink/p/?LinkId=613097) для назначения лицензий. Узнайте, [как использовать PowerShell для автоматически назначение лицензий Your пользователям Office 365](https://go.microsoft.com/fwlink/p?LinkID=329805) для автоматического решения.