---
title: Перемещение сайта OneDrive в другой геообъект
ms.author: mikeplum
author: MikePlumleyMSFT
manager: pamgreen
audience: ITPro
ms.topic: article
ms.service: o365-solutions
ms.custom: ''
ms.collection:
- Strat_SP_gtc
- SPO_Content
localization_priority: Priority
description: Сведения о перемещении сайта OneDrive в другой геообъект.
ms.openlocfilehash: 49fec1359ed839b16c1872ab607d87515a27eaf5
ms.sourcegitcommit: fa900775790eb369db1983cd3868b628b699f145
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/07/2019
ms.locfileid: "38033455"
---
# <a name="move-a-onedrive-site-to-a-different-geo-location"></a>Перемещение сайта OneDrive в другой геообъект 

С помощью функции перемещения OneDrive в отношении геообъекта можно переместить OneDrive пользователя в другое географическое расположение. Перемещение OneDrive в отношении геообъекта выполняет администратор SharePoint Online или глобальный администратор Office 365. Перед началом этого действия предупредите пользователя о переносе его OneDrive и посоветуйте ему закрыть все файлы на время выполнения перемещения. (Если во время перемещения будет открыт какой-либо документ пользователя в клиенте Office, после перемещения такой документ необходимо будет сохранить в новом расположении.) При необходимости перемещение можно запланировать на будущую дату.

Для хранения содержимого служба OneDrive использует хранилище BLOB-объектов Azure. Хранилище BLOB-объектов, связанное с OneDrive пользователя, будет перемещено из исходного в целевой геообъект в течение 40 дней с того момента, как пользователю станет доступным OneDrive в целевом геообъекте. Доступ к OneDrive пользователя будет восстановлен сразу после того, как станет доступным OneDrive в целевом геообъекте.

Пока открыто окно перемещения OneDrive в отношении геообъекта (около 2–6 часов), служба OneDrive пользователя доступна только для чтения. Пользователь по-прежнему сможет получить доступ к своим файлам с помощью клиента синхронизации OneDrive или на сайте OneDrive в SharePoint Online. После перемещения OneDrive в отношении геообъекта пользователь будет автоматически подключен к OneDrive в целевом географическом расположении, когда попробует перейти к OneDrive в средстве запуска приложений Office 365. Клиент синхронизации в новом расположении автоматически начнет синхронизацию.

Процедуры, описываемые в этой статье, требуют наличия [модуля Microsoft SharePoint Online для PowerShell](https://www.microsoft.com/download/details.aspx?id=35588).

## <a name="communicating-to-your-users"></a>Общение с пользователями

При перемещении сайтов OneDrive из одного географического расположения в другое важно объяснить пользователям, чего ожидать. Это поможет избежать недоразумений и снизит количество обращений в службу поддержки. Перед тем как начать перемещение, отправьте пользователям по электронной почте следующую информацию:

- время начала перемещения и его длительность;
- географическое расположение, в которое переносится OneDrive, и новый URL-адрес для доступа к нему;
- напомните, что необходимо закрыть файлы и не редактировать их во время перемещения;
- после перемещения разрешения для файлов и параметры общего доступа к файлам остаются без изменений;
- чего ожидать от [пользовательского интерфейса в среде с поддержкой нескольких регионов](multi-geo-user-experience.md).

Обязательно известите пользователей об успешном окончании перемещения и сообщите, что они могут возобновить работу в OneDrive.

## <a name="scheduling-onedrive-site-moves"></a>Планирование перемещений сайтов OneDrive

Вы можете заранее спланировать перемещения сайтов OneDrive (описано далее в этой статье). Рекомендуется начать с небольшого количества пользователей для проверки рабочих процессов и стратегий коммуникации. После ознакомления с процессом можно планировать перемещения следующим образом:

- Можно запланировать до 4000 перемещений за один раз.
- После начала перемещения можно продолжить планирование, не превышая 4000 ожидаемых перемещений в очереди в любой момент времени.
- Рекомендуется не планировать более 4000 перемещений в месяц.

## <a name="moving-a-onedrive-site"></a>Перемещение сайта OneDrive

Чтобы выполнить перемещение OneDrive в отношении геообъекта, администратор клиента должен сначала задать предпочтительное расположение данных (PDL) пользователя. Указав PDL, подождите как минимум 24 часа, прежде чем приступать к перемещению OneDrive в отношении геообъекта. Это время отведено на синхронизацию обновления PDL между географическими расположениями.

Используя командлеты перемещения в отношении геообъекта, подключитесь к службе SPO в текущем географическом расположении OneDrive пользователя с помощью такого синтаксиса:

`connect-sposervice -url https://<tenantName>-admin.sharepoint.com`

Чтобы переместить, например, OneDrive пользователя matt@contosoenergy.onmicrosoft.com, подключитесь к европейскому Центру администрирования SharePoint, так как OneDrive пользователя находится в Европе.

`connect-sposervice -url https://contosoenergyeur-admin.sharepoint.com`

![Снимок экрана: окно PowerShell с командлетом connect-sposervice](media/move-onedrive-between-geo-locations-image1.png)

## <a name="validating-the-environment"></a>Проверка среды

Прежде чем начинать перемещение OneDrive в отношении геообъекта, рекомендуем проверить среду.

Чтобы проверить, все ли геообъекты совместимы, выполните такую команду:

`Get-SPOGeoMoveCrossCompatibilityStatus`

Вы увидите список ваших геообъектов, а контент, который можно перемещать между ними будет обозначен как Compatible (Совместимый). Если команда возвращает значение Incompatible (Несовместимый), попробуйте проверить состояние позднее.

Переместить службу OneDrive невозможно, если она, к примеру, содержит дочерний сайт. Чтобы проверить возможность перемещения OneDrive, выполните командлет Start-SPOUserAndContentMove с параметром -ValidationOnly.

`Start-SPOUserAndContentMove -UserPrincipalName <UPN> -DestinationDataLocation <DestinationDataLocation> -ValidationOnly`

Если служба OneDrive готова к перемещению, вернется отклик, указывающий на успешное выполнение. Если же есть состояние удержания по юридическим причинам или дочерний сайт, что будет препятствовать перемещению, вернется отклик, указывающий на ошибку. Убедившись в том, что служба OneDrive готова к перемещению, начинайте эту процедуру.

## <a name="start-a-onedrive-geo-move"></a>Перемещение OneDrive в отношении геообъекта

Чтобы начать перемещение, выполните такую команду:  

`Start-SPOUserAndContentMove -UserPrincipalName <UserPrincipalName> -DestinationDataLocation <DestinationDataLocation>`

Используйте эти параметры:

-   _UserPrincipalName_ — имя участника-пользователя, OneDrive которого перемещается.

-   _DestinationDataLocation_ — геообъект, куда следует переместить OneDrive. Он должен совпадать с предпочтительным расположением данных пользователя.

Например, чтобы переместить OneDrive matt@contosoenergy.onmicrosoft.com из Европы в Австралию, выполните такую команду:

`Start-SPOUserAndContentMove -UserPrincipalName matt@contosoenergy.onmicrosoft.com -DestinationDataLocation AUS`

![Снимок экрана: окно PowerShell с командлетом Start-SPOUserAndContentMove](media/move-onedrive-between-geo-locations-image2.png)

Чтобы запланировать перемещение в отношении геообъекта на более позднее время, используйте один из следующих параметров:

-   _PreferredMoveBeginDate_ — предполагаемое время начала перемещения. Должно быть задано в формате UTC.

-   _PreferredMoveEndDate_ — предполагаемое время завершения перемещения (самый короткий период). Должно быть задано в формате UTC. 

## <a name="cancel-a-onedrive-geo-move"></a>Отмена перемещения OneDrive в отношении геообъекта 

Перемещение OneDrive пользователя в отношении геообъекта можно остановить, если этот процесс не находится на этапе выполнения или не завершен с помощью такого командлета:

`Stop-SPOUserAndContentMove – UserPrincipalName <UserPrincipalName>`

Здесь _UserPrincipalName_ — имя участника-пользователя, перемещение OneDrive которого нужно остановить.

## <a name="determining-current-status"></a>Определение текущего состояния

С помощью командлета Get-SPOUserAndContentMoveState вы можете проверить состояние перемещения OneDrive в отношении геообъекта (в расположение или из расположения), к которому подключены.

Состояния перемещения описаны в приведенной ниже таблице.

<table>
<thead>
<tr class="header">
<th align="left"><strong>Состояние</strong></th>
<th align="left"><strong>Описание</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NotStarted</td>
<td align="left">Перемещение не начато.</td>
</tr>
<tr class="even">
<td align="left">InProgress (<em>n</em>/4)</td>
<td align="left">Перемещение в процессе и находится в одном из следующих состояний: "проверка" (1/4), "резервное копирование" (2/4), "восстановление" (3/4), "очистка" (4/4).</td>
</tr>
<tr class="odd">
<td align="left">Success</td>
<td align="left">Перемещение успешно завершено.</td>
</tr>
<tr class="even">
<td align="left">Failed</td>
<td align="left">Перемещение не удалось выполнить.</td>
</tr>
</tbody>
</table>

Чтобы найти состояние перемещения определенного пользователя, используйте параметр UserPrincipalName.

`Get-SPOUserAndContentMoveState -UserPrincipalName <UPN>`

Чтобы найти состояние всех перемещений в геообъект или из геообъекта, к которому вы подключены, используйте параметр MoveState с одним из следующих значений: NotStarted, InProgress, Success, Failed, All.

`Get-SPOUserAndContentMoveState -MoveState <value>`

Для более подробного описания состояния перемещения вы можете добавить параметр `-Verbose`.

## <a name="user-experience"></a>Взаимодействие с пользователем

Перемещение OneDrive пользователей в другой геообъект должно проходить максимально незаметно для них. Если не считать кратковременного состояния доступа только для чтения при перемещении, после завершения этого процесса существующие ссылки и разрешения будут доступны в обычном режиме.

### <a name="onedrive-for-business"></a>OneDrive для бизнеса

Во время перемещения служба OneDrive пользователя доступна только для чтения. Когда перемещение завершится, при попытке пользователя перейти к OneDrive в средстве запуска приложений Office 365 или веб-браузере он будет направлен к OneDrive в новом географическом расположении.

### <a name="permissions-on-onedrive-content"></a>Разрешения для содержимого OneDrive

У пользователей с разрешениями для содержимого OneDrive будет к нему доступ во время перемещения и после его завершения.

### <a name="onedrive-sync-client"></a>Клиент синхронизации OneDrive 

Когда будет выполнено перемещение OneDrive в отношении геообъекта, клиент синхронизации OneDrive автоматически обнаружит и легко перенесет синхронизацию в новое расположение OneDrive. Пользователю не нужно выполнять повторный вход или любые другие действия. (Требуется клиент синхронизации версии 17.3.6943.0625 или более поздней.)

Если пользователь попробует обновить файл во время перемещения OneDrive в отношении геообъекта, клиент синхронизации уведомит его о том, что отправка файла при выполнении перемещения приостанавливается.

### <a name="sharing-links"></a>Предоставление ссылок 

Когда перемещение OneDrive в отношении геообъекта будет завершено, для существующих предоставленных ссылок на перемещенные файлы будет автоматически выполняться перенаправление на новый геообъект.

### <a name="onenote-experience"></a>Интерфейс OneNote 

Когда перемещение OneDrive в отношении геообъекта будет завершено, приложение UWP (универсальное) и клиент OneNote win32 автоматически обнаружат и легко синхронизируют записные книжки с новым расположением OneDrive. Пользователю не нужно будет выполнять повторный вход или любые другие действия. Во время выполнения перемещения OneDrive в отношении геообъекта единственным отображаемым индикатором для пользователя является уведомление об ошибке синхронизации записной книжки. Эта возможность доступна для следующих клиентских версий OneNote:

-   OneNote win32 версии 16.0.8326.2096 (или более поздней);

-   OneNote UWP версии 16.0.8431.1006 (или более поздней);

-   приложение OneNote Mobile версии 16.0.8431.1011 (или более поздней).

### <a name="teams-app"></a>Приложение Teams

Когда перемещение OneDrive в отношении геообъекта будет завершено, пользователи получат доступ к своим файлам OneDrive в приложении Teams. Кроме того, файлы, отправленные из OneDrive через чат Teams до такого перемещения, будут продолжать работать и после него.

### <a name="onedrive-for-business-mobile-app-ios"></a>Мобильное приложение OneDrive для бизнеса (iOS) 

Когда перемещение OneDrive в отношении геообъекта будет завершено, пользователю понадобится выйти из мобильного приложения для iOS и снова войти в него. Благодаря этому будет выполнена синхронизация с новым расположением OneDrive.

### <a name="existing-followed-groups-and-sites"></a>Существующие отслеживаемые группы и сайты

Отслеживаемые сайты и группы будут отображаться в учетной записи OneDrive для бизнеса пользователя независимо от его географического расположения. Сайты и группы, размещенные в другом геообъекте, откроются на отдельной вкладке.
