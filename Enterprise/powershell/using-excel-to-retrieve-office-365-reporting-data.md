---
title: "Использование Excel для получения отчетных данных Office 365"
ms.author: josephd
author: JoeDavies-MSFT
manager: laurawi
ms.date: 12/15/2017
ms.audience: ITPro
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.collection: Ent_O365
ms.custom:
- DecEntMigration
- Ent_Office_Other
- PowerShell
ms.assetid: 510d5528-ac00-4f54-9d38-75fa043d0a06
description: "Сводка: в этой статье рассказывается, как с помощью компонента oData в Microsoft Excel получить подробные сведения из отчета о развертывании Office 365:."
ms.openlocfilehash: 72c0fce0a70f5cc3136ab01b48bb178d32a8f64d
ms.sourcegitcommit: d31cf57295e8f3d798ab971d405baf3bd3eb7a45
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/15/2017
---
# <a name="using-excel-to-retrieve-office-365-reporting-data"></a>Использование Excel для получения отчетных данных Office 365

 **Сводка:** Используйте функцию oData в Microsoft Excel для получения подробных отчетов сведений для развертывания Office 365
  
Отчеты  важная составляющая администрирования системы. Центр администрирования Office 365: включает ряд готовых отчетов, доступных в разделе **Отчеты** в левой области навигации. Среди них есть отчеты об использовании, а также о безопасности и соответствии требованиям.
  
Доступные вам отчеты зависят от используемой версии Office 365: и включенных служб Office 365:. Дополнительные сведения см. в статье [Отчеты](https://technet.microsoft.com/en-us/library/office-365-reports.aspx).
  
Готовые отчеты Центра администрирования являются отличным ресурсом. Они упрощают проверку таких параметров, как использование почтовых ящиков и время, проведенное вашими пользователями на конференциях по сети. Тем не менее, отчеты имеют определенные ограничения в отношении подробного анализа домена Office 365:.
  
Один из способов обойти эти ограничения  использовать Windows PowerShell или другой язык разработки для доступа к службе отчетов Office 365: и создания пользовательских отчетов. Пользовательские отчеты позволяют вам выбирать данные, которые будет возвращать служба отчетов Office 365:. Составляя пользовательские отчеты, вы также можете выбирать способ сортировки и группировки данных, а также (если это применимо) способ сохранения данных. Например, данные можно сохранять в формате XML или файле с разделителями-запятыми, который легко импортировать в Excel. 
  
Кроме того, пользовательские сценарии и приложения позволяют получать доступ к отчетам, недоступным из Центра администрирования Office 365:. Например, в Центре администрирования можно узнать, сколько у вас неактивных почтовых ящиков, но нельзя узнать, какие почтовые ящики не использовались за последние 30 дней. Однако это можно узнать с помощью пользовательского сценария PowerShell. Это обеспечивает высокую гибкость при том, что вам требуется написать короткий и относительно простой сценарий Windows PowerShell.
  
> [!VISUAL BASIC NOTE] Дополнительные сведения см. на [главной странице](https://msdn.microsoft.com/en-us/library/office/jj984325%28v=office.15%29.aspx) службы отчетов Office 365:.
  
Для получения данных необходимо написать код того или иного типа. Это оправдано, если вы работаете в крупной организации, где требуется ограничить количество и тип возвращаемой информации. Но что если ваша организация небольшая и вам не требуется ограничивать количество и тип возвращаемой информации? В таком случае вы можете открывать отчеты Office 365: непосредственно в Excel.
  
Однако существует ряд ограничений, в первую очередь следующего: нельзя фильтровать, сортировать, выделять данные и выполнять с ними другие действия до того, как они будут возвращены. Вместо этого можно просто вернуть набор данных, возвращаемых отчетом по умолчанию. В некоторых случаях данных может быть недостаточно. Например, отчет может вернуть данные только за предыдущий месяц, а не за весь год. С другой стороны, иногда данных может быть слишком много: вы можете получить данные за весь год, хотя вас интересуют только данные за предыдущий месяц.
  
Чтобы открыть отчет Office 365: непосредственно в Excel, выполните указанные ниже действия.
  
1. Для начала откройте новый лист в Excel. На этом листе нажмите **Данные**, **Из других источников** и **Из веб-канала данных OData**. Откроется диалоговое окно **Мастер подключения данных**:
    
     ![Пример диалогового окна "Подключение к каналу данных" в мастере подключения данных.](images/o365_reporting_connect_data_feed.png)
  
2. На странице **Подключение к каналу данных** введите расположение канала **https://reports.office365.com/ecp/reportingwebservice/reporting.svc/**. Обратите внимание, что вводить базовый URL-адрес можно только в таком виде, не добавляя операторов выбора, фильтрации и форматирования. Если ввести что-либо, кроме базового URL-адреса, данные не будут возвращаться. Вместо этого появится следующее сообщение об ошибке:
    
     ![Пример сообщения об ошибке при добавлении операторов Select, Filter или Format.](images/o365_reporting_incorrect_data_feed.png)
  
3. Указав URL-адрес службы отчетов, выберите параметр **Использовать эти имя и пароль** в разделе **Учетные данные входа в систему**. В поле **Имя пользователя** введите свое имя в Office 365: (например, admin@litwareinc.onmicrosoft.com). В поле **Пароль** введите свой пароль для входа в Office 365:, а затем нажмите кнопку **Далее**. Затем Excel попробует подключиться к службе отчетов с помощью указанных учетных данных.
    
4. После проверки подлинности откроется страница **Выбор таблиц**. Выберите нужный отчет (например, **MailTrafficTop** ) и нажмите кнопку **Далее**:
    
     ![Пример страницы "Выбор таблиц" в мастере подключения данных.](images/o365_reporting_select_tables.png)
  
    > [!NOTE]
    > Вы можете выбрать несколько отчетов. При этом в электронную таблицу Excel будет добавлено несколько таблиц или диаграмм. Можно даже создать одну таблицу или диаграмму, объединяющую данные из нескольких отчетов. Тем не менее, мы не будем обсуждать это во вводной статье. 
  
5. После нажатия кнопки **Далее** откроется страница **Сохраните файл подключения данных и завершите работу**:
    
     ![Пример страницы "Сохраните файл подключения данных и завершите работу" в мастере подключения данных.](images/o365_reporting_odata_finish.png)
  
    На ней не требуется вводить никаких сведений. Для получения данных достаточно нажать кнопку **Готово**. Тем не менее важно отменить, что по умолчанию Excel сохраняет сведения о каждом подключении к данным. Эти данные хранятся в папке **Мои источники данных**:
    
     ![Пример диалогового окна "Сохранение файла" для папки "Мои источники данных".](images/o365_reporting_save_data_source.png)
  
    По этой причине диалоговое окно содержит текстовые поля с такими заголовками, как **Понятное имя** и **Ключевые слова поиска**. Эти параметры позволяют настраивать подключения к данным. Благодаря этому вам не придется иметь дело с большим количеством источников данных, вроде этих:
    
  ```
  DataFeed_1_reports-office365-com ClientSoftwareBrowserDetail.odc
DataFeed_1_reports-office365-com MailTrafficTop.odc
DataFeed_1_reports-office365-com Multiple Tables.odc
DataFeed_2_reports-office365-com MailboxActivityWeekly.odc
DataFeed_2_reports-office365-com MailTrafficTop.odc
DataFeed_3_reports-office365-com ClientSoftwareBrowserDetail.odc
  ```

Установив флажок **Сохранить пароль в файле**, вы сможете повторно использовать эти каналы данных. Допустим, вы сохраняете подключение к данным как **отчет браузера клиента**. В следующий раз, когда вам понадобятся сведения о веб-браузерах, используемых для доступа к домену Office 365:, вам не придется использовать мастер подключения данных. Вместо этого достаточно будет открыть Excel, нажать **Данные** и выбрать **Существующие источники**. Выберите нужное подключение к данным в диалоговом окне **Существующие подключения** и нажмите кнопку **ОК**:
    
![Пример выбора подключения к данным в диалоговом окне "Существующие подключения".](images/o365_reporting_select_connection.png)
  
После этого Excel выполнит подключение и получит данные.
    
Обратите внимание, что эти файлы ODC представляют собой текстовые файлы XML, в которых указаны ваши имя пользователя и пароль Office 365::
    
\<ODC:ConnectionString > источник данных = https://reports.office365.com/ecp/reportingwebservice/reporting.svc/; Пространства имен для включения = *; Максимальное число полученных размер сообщения = 4398046511104; Integrated Security = Basic; ID=admin@litwareinc.onmicrosoft.com; **пользователя Пароль = MYpassw0rd!**; Сохранять сведения о безопасности = false. URL-адрес службы документов = https://reports.office365.com/ecp/reportingwebservice/reporting.svc/\</odc:ConnectionString >
    
Если вы не хотите сохранять свои имя пользователя и пароль в текстовом файле, не устанавливайте флажок **Сохранить пароль в файле**. Однако в этом случае следует помнить, что вы не сможете повторно использовать эти подключения к данным. Это вызвано тем, что без имени пользователя и пароля Office 365: не сможет проверить подлинность вашей попытки входа в службу.
    
6. Нажмите кнопку **Готово** на странице **Сохраните файл подключения данных и завершите работу**, и откроется диалоговое окно **Импорт данных**:
    
     ![Пример диалогового окна "Импорт данных".](images/o365_reporting_import_data.png)
  
7. Выберите варианты отображения (например, **Отчет сводной таблицы** ) и нажмите кнопку **ОК**. Если все пройдет успешно, ваши данные будут импортированы и представлены в выбранном варианте отображения:
    
     ![Пример успешного импорта данных на лист Excel.](images/o365_reporting_sample_spreadsheet.png)
  
Вы можете использовать эти данные по своему усмотрению. Рекомендации см. в статье [Создание панели мониторинга служб Excel с помощью веб-канала данных OData](https://technet.microsoft.com/en-us/library/jj873965%28v=office.15%29.aspx). Хотя в этой статье не используется служба отчетов Office 365:, в ней приводится некоторые полезные советы по таким действиям, как добавление фильтров и срезов на новую панель мониторинга.
  
## <a name="see-also"></a>See also

#### 

[Управление Office 365 с помощью PowerShell Office 365](manage-office-365-with-office-365-powershell.md)
  
[Начало работы с Office 365 PowerShell](getting-started-with-office-365-powershell.md)
  
[Использование Windows PowerShell для создания отчетов в Office 365](use-windows-powershell-to-create-reports-in-office-365.md)

