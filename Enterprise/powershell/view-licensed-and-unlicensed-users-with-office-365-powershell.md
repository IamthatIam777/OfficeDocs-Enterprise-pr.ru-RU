---
title: "Отображение списков пользователей с лицензиями и пользователей без лицензий с помощью Office 365 PowerShell"
ms.author: josephd
author: JoeDavies-MSFT
manager: laurawi
ms.date: 12/15/2017
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.collection: Ent_O365
ms.custom: O365ITProTrain, Ent_Office_Other, PowerShell
ms.assetid: e4ee53ed-ed36-4993-89f4-5bec11031435
description: "В этой статье рассказывается, как использовать PowerShell в Office 365 для просмотра учетных записей пользователей с лицензиями и пользователей без лицензий."
ms.openlocfilehash: e691ba7db96b34166f03ccd90d87fee0d2ee09f8
ms.sourcegitcommit: c16db80a2be81db876566c578bb04f3747dbd50c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/13/2018
---
# <a name="view-licensed-and-unlicensed-users-with-office-365-powershell"></a>Отображение списков пользователей с лицензиями и пользователей без лицензий с помощью Office 365 PowerShell

**Сводка.** Узнайте, как просмотреть учетные записи пользователей Office 365 с лицензиями и без них, используя PowerShell.
  
Учетным записям пользователей в организации Office 365 могут быть назначены все лицензии из доступных планов, часть лицензий или вообще ни одной. С помощью PowerShell в Office 365 вы можете быстро найти пользователей в организации, у которых есть лицензии, и тех пользователей, у которых их нет.
  
## <a name="before-you-begin"></a>Перед началом работы

- Для выполнения действий, описанных в этой статье, требуется подключение к PowerShell в Office 365. Инструкции см. в статье [Подключение к Office 365 PowerShell](connect-to-office-365-powershell.md).
    
- Если использовать командлет **Get-MsolUser** без параметра _-All_, возвращаются только первые 500 учетных записей.
    
## <a name="the-short-version-instructions-without-explanations"></a>Краткая версия (инструкции без пояснений)

В этом разделе процедуры представлены без подробных объяснений. Дополнительную информацию можно найти в следующем разделе статьи.
  
Чтобы просмотреть список всех учетных записей пользователей в организации и сведения об их состояниях лицензирования, выполните следующую команду в Office 365 PowerShell:
  
```
Get-MsolUser -All
```

Чтобы отобразить список всех учетных записей пользователей без лицензий в вашей организации, выполните указанную ниже команду.
  
```
Get-MsolUser -All -UnlicensedUsersOnly
```

Чтобы отобразить список всех учетных записей пользователей с лицензиями в вашей организации, выполните указанную ниже команду.
  
```
Get-MsolUser -All | where {$_.isLicensed -eq $true}
```

## <a name="the-long-version-instructions-with-detailed-explanations"></a>Подробная версия (инструкции с подробными пояснениями)

Между учетными записями пользователей Office 365 и лицензиями на Office 365 может не быть взаимно-однозначного соответствия: могут быть пользователи без лицензий и лицензии без пользователей (у одного пользователя даже может быть *несколько* лицензий). При создании учетной записи пользователя Office 365 (дополнительные сведения см. в статье [Лицензирование пользователей Office 365 с помощью Windows PowerShell](http://technet.microsoft.com/library/0ab9fcac-e5ea-4b5b-b72c-8c92c55565ac.aspx)) необязательно назначать ему лицензию: у нового пользователя будет действительная учетная запись, но он не сможет войти в Office 365. При попытке входа он увидит примерно следующее:
  
![Пользователь без действительной лицензии на Office 365.](images/o365_powershell_no_license.png)
  
Аналогично, пользователь может уйти во внеплановый отпуск, например творческий или декретный. В таком случае вы можете удалить лицензию этого пользователя, оставив учетную запись нетронутой (то есть оставив без изменений значения всех ее свойств, такие как адрес, номер телефона и т. д). Благодаря этому вы можете назначить освободившуюся лицензию другому пользователю (например, временному сотруднику, занявшему должность пользователя, который ушел в отпуск). Когда пользователь вернется на работу, вы можете выдать ему новую лицензию, чтобы тот смог сразу вернуться к выполнению своих задач.
  
Таким образом, у вас могут быть пользователи с учетными записями без лицензий или наоборот.
  
В статье [Просмотр лицензий и служб с помощью Office 365 PowerShell](view-licenses-and-services-with-office-365-powershell.md) описано, как определить количество приобретенных вашей организацией лицензий на Office 365 и сколько из них назначены пользователям. Это важные сведения. Не менее важно знать, каким пользователям назначены лицензии, а каким — нет. И в этой статье мы расскажем, как это узнать.
  
Как вам наверняка известно, командлет **Get-MsolUser** возвращает сведения обо всех учетных записях пользователей Office 365. Хотите быстро получить сведения обо всех пользователях Office 365? Выполните следующую команду в Office 365 PowerShell:
  
```
Get-MsolUser
```

Командлет Get-MsolUser возвращает примерно такие данные:
  
```
UserPrincipalName           DisplayName                     isLicensed
-----------------           -----------                     ----------
ZrinkaM@litwareinc.com      Zrinka Makovac                  True
BelindaN@litwareinc.com     Belinda Newman                  False
BonnieK@litwareinc.com      Bonnie Kearney                  True
FabriceC@litwareinc.com     Fabrice Canel                   True
AnneW@litwareinc.com        Anne Wallace                    True
AlexD@litwareinc.com        Alex Darrow                     True
```

Как видите, одно из возвращенных значений относится к свойству **isLicensed**. Если для свойства **isLicensed** задано значение `False`, то у пользователя нет лицензии на Office 365. Другими словами, вы могли бы просто прокрутить список пользователей и выбрать тех из них, для свойства **isLicensed** которых задано значение `False`.
  
В любом случае, прокрутить список и выбрать нелицензированных пользователей можно, только если пользователей относительно немного. Однако при наличии большого числа пользователей это очень трудоемкая задача. Кроме того, при определенной конфигурации Windows PowerShell это может быть попросту невозможно, так как в Windows PowerShell существует ограничение на количество строк выходных данных, которые могут одновременно отображаться.
  
Таким образом, намного более эффективный способ получить список нелицензированных пользователей — выполнить следующую команду:
  
```
Get-MsolUser -UnlicensedUsersOnly
```

Эта команда возвращает только тех пользователей, у которых нет лицензии на Office 365. Другими словами:
  
```
UserPrincipalName           DisplayName                     isLicensed
-----------------           -----------                     ----------
BelindaN@litwareinc.com     Belinda Newman                  False
```

Как видите, имеется один пользователь без лицензии. А что, если нам нужен список только *лицензированных* пользователей? Это немного сложнее:
  
```
Get-MsolUser | Where-Object {$_.isLicensed -eq $true}
```

Эта команда ищет все учетные записи пользователей, для свойства **isLicensed** которых задано значение `True`, и возвращает примерно такие сведения:
  
```
UserPrincipalName           DisplayName                     isLicensed
-----------------           -----------                     ----------
ZrinkaM@litwareinc.com      Zrinka Makovac                  True
BonnieK@litwareinc.com      Bonnie Kearney                  True
FabriceC@litwareinc.com     Fabrice Canel                   True
AnneW@litwareinc.com        Anne Wallace                    True
AlexD@litwareinc.com        Alex Darrow                     True
```

Как видите, сведения о пользователе Belinda Newman не возвращаются. Почему? Очень просто: для свойства **isLicensed** этой учетной записи не задано значение `True`.
  
## <a name="see-also"></a>См. также
<a name="SeeAlso"> </a>

Дополнительные сведения о командлетах, использованных в этих процедурах, см. в указанных ниже статьях.
  
- [Get-MsolUser](https://go.microsoft.com/fwlink/p/?LinkId=691547)
    
- [Where-Object](https://go.microsoft.com/fwlink/p/?LinkId=113423)
    

