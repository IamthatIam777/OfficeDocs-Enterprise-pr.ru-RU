---
title: Использование командлетов PowerShell для централизованного развертывания для управления надстройками
ms.author: twerner
author: twernermsft
manager: scotv
ms.date: 5/31/2017
audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
search.appverid:
- MET150
- MOE150
- MED150
- MBS150
- BCS160
ms.assetid: 94f4e86d-b8e5-42dd-b558-e6092f830ec9
description: Используйте командлеты PowerShell централизованного развертывания для развертывания надстроек Office для организации Office 365 и управления ими.
ms.openlocfilehash: 301e44da4c663fa54c4e2b753552b0b345e2a6e5
ms.sourcegitcommit: 9cd3dcf1e90b21c7651d367dcd3306d6fe0bcbcb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2019
ms.locfileid: "35834239"
---
# <a name="use-the-centralized-deployment-powershell-cmdlets-to-manage-add-ins"></a>Использование командлетов PowerShell для централизованного развертывания для управления надстройками

Как глобальный администратор Microsoft 365 или администратор Exchange вы можете развертывать надстройки Office для пользователей с помощью функции централизованного развертывания (см. раздел [Развертывание надстроек Office в центре администрирования](https://support.office.com/article/737e8c86-be63-44d7-bf02-492fa7cd9c3f.aspx)). Кроме развертывания надстроек Office с помощью центра администрирования Microsoft 365, вы также можете использовать Microsoft PowerShell. Установите [модуль развертывания Office 365 с централизованной надстройкой для Windows PowerShell](https://www.powershellgallery.com/packages/O365CentralizedAddInDeployment). 

После загрузки модуля откройте обычное окно Windows PowerShell и запустите следующий командлет:

```powershell
 Import-Module -Name O365CentralizedAddInDeployment
```
    
## <a name="connect-using-your-admin-credentials"></a>Подключение с использованием учетных данных администратора

Прежде чем использовать командлеты централизованного развертывания, необходимо войти в систему.
  
1. Запустите PowerShell.
    
2. Подключитесь к PowerShell с помощью учетных данных администратора компании. Выполните следующий командлет.
    
  ```powershell
  Connect-OrganizationAddInService
  ```

3. На странице **введите учетные данные** введите учетные данные глобального администратора Office 365. Кроме того, вы можете ввести свои учетные данные непосредственно в командлет. 
    
    Выполните следующий командлет, указав учетные данные администратора компании в качестве объекта PSCredential.
    
  ```powershell
  $secpasswd = ConvertTo-SecureString "MyPassword" -AsPlainText -Force
  $mycredentials = New-Object System.Management.Automation.PSCredential ("serviceaccount@contoso.com", $secpasswd)
  Connect-OrganizationAddInService -Credential $mycredentials
  ```

> [!NOTE]
> Дополнительные сведения об использовании PowerShell приведены в статье [Подключение к Office 365 PowerShell](https://go.microsoft.com/fwlink/p/?linkid=848585). 
  
## <a name="upload-an-add-in-manifest"></a>Отправка манифеста надстройки

Выполните командлет **New-организациянадстройки-in** , чтобы отправить манифест надстройки по пути, который может представлять собой расположение файла или URL-адрес. В следующем примере показано расположение файла для значения параметра _манифестпас_ . 
  
```powershell
New-OrganizationAddIn -ManifestPath 'C:\Users\Me\Desktop\taskpane.xml' -Locale 'en-US'
```

Кроме того, можно выполнить командлет **New – организациянадстройки – in** , чтобы отправить надстройку и назначить ее пользователям или группам напрямую с помощью параметра Members __ , как показано в следующем примере. Разделяйте адреса электронной почты членов запятыми. 
  
```powershell
New-OrganizationAddIn -ManifestPath 'C:\Users\Me\Desktop\taskpane.xml' -Locale 'en-US' -Members  'KathyBonner@contoso.com', 'MaxHargrave@contoso.com'
```

## <a name="upload-an-add-in-from-the-office-store"></a>Отправка надстройки из магазина Office

Выполните командлет **New – организатионаддин** , чтобы отправить манифест из магазина Office.
  
В следующем примере командлет **New – организатионаддин** указывает ассетид для надстройки для местонахождения США и рынка контента.
  
```powershell
New-OrganizationAddIn -AssetId 'WA104099688' -Locale 'en-US' -ContentMarket 'en-US'
```

Чтобы определить значение параметра _ассетид_ , можно скопировать его из URL-адреса веб-страницы магазина Office для надстройки. Ассетидс всегда начинается с "WA", за которым следует число. Например, в предыдущем примере источник для значения Ассетид для WA104099688 — это URL-адрес веб-страницы магазина Office для надстройки: [https://store.office.com/en-001/app.aspx?assetid=WA104099688](https://store.office.com/en-001/app.aspx?assetid=WA104099688).
  
Значения параметра _locale_ и параметра _контентмаркет_ идентичны и указывают страну или регион, из которого вы пытаетесь установить надстройку. Формат — en-US, fr-FR. и т. д. 
  
> [!NOTE]
> Надстройки, отправленные из магазина Office, автоматически обновляются в течение нескольких дней с последнего обновления, доступного в магазине Office. 
  
## <a name="get-details-of-an-add-in"></a>Получение сведений о надстройке

Выполните командлет **Get – организатионаддин** , как показано ниже, чтобы получить сведения обо всех надстройках, отправленных в клиент, включающих идентификатор продукта надстройки.
  
```powershell
Get-OrganizationAddIn
```

Выполните командлет **Get – организатионаддин** со значением параметра _ProductID_ , чтобы указать, для какой надстройки необходимо получить сведения. 
  
```powershell
Get-OrganizationAddIn -ProductId 6a75788e-1c6b-4e9b-b5db-5975a2072122
```

Чтобы получить полные сведения обо всех надстройках, а также о назначенных пользователях и группах, перечислите выходные данные командлета **Get – организатионаддин** в командлет Format – List, как показано в следующем примере.
  
```powershell
Get-OrganizationAddIn |Format-List
```

## <a name="turn-on-or-turn-off-an-add-in"></a>Включение и отключение надстройки

Чтобы отключить надстройку, чтобы пользователи и группы, которым назначена эта надстройка, больше не были доступны, выполните командлет **Set – организатионаддин** с параметром _ProductID_ и параметром _Enabled_ `$false`, равным, как показано в следующем примере. .
  
```powershell
Set-OrganizationAddIn -ProductId 6a75788e-1c6b-4e9b-b5db-5975a2072122 -Enabled $false
```

Чтобы снова включить надстройку, выполните тот же командлет, для `$true`параметра _Enabled_ которого задано значение.
  
```powershell
Set-OrganizationAddIn -ProductId 6a75788e-1c6b-4e9b-b5db-5975a2072122 -Enabled $true
```

## <a name="add-or-remove-users-from-an-add-in"></a>Добавление и удаление пользователей из надстройки

Чтобы добавить пользователей и группы в определенную надстройку, выполните командлет **Set – организатионаддинассигнментс** с параметрами _ProductID_, _Add_и Members. __ Разделяйте адреса электронной почты членов запятыми. 
  
```powershell
Set-OrganizationAddInAssignments -ProductId 6a75788e-1c6b-4e9b-b5db-5975a2072122 -Add -Members 'KathyBonner@contoso.com','sales@contoso.com'
```

Чтобы удалить пользователей и группы, выполните один командлет с параметром _Remove_ . 
  
```powershell
Set-OrganizationAddInAssignments -ProductId 6a75788e-1c6b-4e9b-b5db-5975a2072122 -Remove -Members 'KathyBonner@contoso.com','sales@contoso.com'
```

Чтобы назначить надстройку всем пользователям в клиенте, выполните тот же командлет с параметром _ассигнтоеверйоне_ , для `$true`которого задано значение.
  
```powershell
Set-OrganizationAddInAssignments -ProductId 6a75788e-1c6b-4e9b-b5db-5975a2072122 -AssignToEveryone $true
```

Чтобы не присваивать надстройке всем пользователям и вернуться к ранее назначенным пользователям и группам, можно выполнить один и тот же командлет и отключить параметр _ассигнтоеверйоне_ , присвоив ему значение `$false`.
  
```powershell
Set-OrganizationAddInAssignments -ProductId 6a75788e-1c6b-4e9b-b5db-5975a2072122 -AssignToEveryone $false
```

## <a name="update-an-add-in"></a>Обновление надстройки

Чтобы обновить надстройку с помощью манифеста, выполните командлет **Set – организатионаддин** с параметрами _ProductID_, _манифестпас_и _locale_ , как показано в следующем примере. 
  
```powershell
Set-OrganizationAddIn -ProductId 6a75788e-1c6b-4e9b-b5db-5975a2072122 -ManifestPath 'C:\Users\Me\Desktop\taskpane.xml' -Locale 'en-US'
```

> [!NOTE]
> Надстройки, отправленные из магазина Office, автоматически обновляются в течение нескольких дней с последнего обновления, доступного в магазине Office. 
  
## <a name="delete-an-add-in"></a>Удаление надстройки

Чтобы удалить надстройку, запустите командлет Remove **– организатионаддин** с параметром _ProductID_ , как показано в следующем примере. 
  
```powershell
Remove-OrganizationAddIn -ProductId 6a75788e-1c6b-4e9b-b5db-5975a2072122
```

## <a name="customize-microsoft-store-add-ins-for-your-organization"></a>Настройка надстроек Microsoft Store для Организации

Перед развертыванием надстройки в Организации ее необходимо настроить. Надстройки более ранние, чем версия 1,1, не поддерживаются этой функцией. 

Рекомендуется сначала развернуть пользовательскую надстройку, чтобы убедиться, что она работает должным образом, прежде чем развертывать ее во всей Организации.

Кроме того, обратите внимание на следующие ограничения:
- Все URL-адреса должны быть абсолютными (включая HTTP или HTTPS) и допустимыми.
- *Отображаемое имя* не должно превышать 125 символов 
- *DisplayName*, *ресурсы* и *AppDomain* не должны содержать следующие символы: 
 
    - \<
    -  \>
    -  ;
    -  =   

Если вы хотите настроить развернутую надстройку, необходимо удалить ее из центра администрирования, а затем удалить надстройку из [локального кэша](#remove-an-add-in-from-local-cache) , чтобы удалить ее с каждого компьютера, на котором она была развернута.

Чтобы настроить надстройку, выполните командлет **Set – организатионаддиноверридес** с *ProductID* в качестве параметра, а затем тег, который необходимо перезаписать, и новое значение. Чтобы узнать, как получить код *продукта* , ознакомьтесь со статьей [Получение сведений о надстройке](#get-details-of-an-add-in) в этой статье. Пример:

```powershell
 Set-OrganizationAddInOverrides -ProductId 5b31b349-2c41-4f94-b720-6ee40349d391 -IconUrl "http://site.com/img.jpg" 
```
Чтобы настроить несколько тегов для надстройки, добавьте эти теги в командную строку:

```powershell
Set-OrganizationAddInOverrides -ProductId 5b31b349-2c41-4f94-b720-6ee40349d391 -Hosts h1, 2 -DisplayName "New DocuSign W" -IconUrl "http://site.com/img.jpg" 
```

> [!IMPORTANT]
> К одной надстройке необходимо применить несколько настраиваемых тегов с одной командой. Если вы настраиваете Теги один на один, то применяется только последняя настройка. Кроме того, если вы настраиваете тег по ошибке, необходимо удалить все настройки и начать заново.

### <a name="tags-you-can-customize"></a>Теги, которые можно настраивать

| Tag                  | Описание          |
| :------------------- | :------------------- |
| \<IconURL>   </br>| URL-адрес изображения, используемого в качестве значка надстройки (в центре администрирования). </br> |
| \<DisplayName>| Название надстройки (в центре администрирования).|
| \<Hosts>| Список приложений, которые будут поддерживать надстройку.|
| \<SourceLocation> | URL-адрес источника, к которому будет подключаться надстройка.| 
| \<> AppDomains | Список доменов, с которыми может подключаться надстройка. | 
| \<SupportURL>| URL-адрес, с помощью которого пользователи могут получать доступ к справке и поддержке. | 
| \<Ресурсы>  | Этот тег содержит ряд элементов, в том числе заголовки, подсказки и значки разного размера.| 
|
### <a name="customize-resources-tag"></a>Настройка тега Resources

Любой элемент в <Resources> теге манифеста может быть динамически настраиваемым. Сначала необходимо проверить манифест, чтобы найти идентификатор элемента, которому требуется назначить новое значение. <Resources> Тег выглядит следующим образом:

```
<Resources>  
    <bt:Images> 
          <bt:Image id=”img16icon” DefaultValue=”http://site.com/img.jpg” 
    </bt:Images> 
</Resources> 
``` 
В этом случае идентификатор элемента изображения — "img16icon", а связанное с ним значение — "http:<i></i>//Сите. <i> </i>com/IMG. jpg. "

Определив элементы, которые вы хотите настроить, выполните следующую команду в PowerShell, чтобы присвоить элементам новые значения:

```powershell
Set-OrganizationAddInOverrides -Resources @{“ElementID” = “New Value”; “NextElementID” = “Next New Value”} 
```

Вы можете настроить любое количество элементов с помощью команды.

### <a name="remove-customization-from-an-add-in"></a>Удаление настроек из надстройки

Единственным вариантом, доступным для удаления настроек, является удаление всех из них одновременно:

```powershell
Remove-OrganizationAddInOverrides -ProductId 5b31b349-2c41-4f94-b720-6ee40349d391 
```

### <a name="view-add-in-customizations"></a>Просмотр настроек надстроек

Чтобы просмотреть список примененных настроек, выполните командлет **Get – организатионаддиноверридес** . Если командлет **Get-организатионаддиноверридес** запускается без *ProductID* , возвращается список всех надстроек с примененными переопределениями.  

```powershell
Get-OrganizationAddInOverrides 
```
Если указан ProductId, возвращается список переопределений, примененных к этой надстройке. 

```powershell
Get-OrganizationAddInOverrides -ProductId 5b31b349-2c41-4f94-b720-6ee40349d391 
```

### <a name="remove-an-add-in-from-local-cache"></a>Удаление надстройки из локального кэша

Если надстройка была развернута, ее необходимо удалить из кэша на каждом компьютере перед настройкой. Чтобы ремиве надстройку из кэша:

1. Переход к папке "Пользователи" в C:\ 
1. Переход к папке пользователя
1. Перейдите к Аппдата\локал\микрософт\оффице и выберите папку, связанную с версией Office.
1. В папке *WEF* удалите папку *манифестов* .

## <a name="get-detailed-help-for-each-cmdlet"></a>Получение подробной справки для каждого командлета

С помощью командлета Get – Help можно просмотреть подробную справку для каждого командлета. Например, следующий командлет предоставляет подробные сведения о командлете Remove – Организатионаддин.
  
```powershell
Get-help Remove-OrganizationAddIn -Full
```


